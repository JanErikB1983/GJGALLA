<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bordplassering | Grønn Jobb Galla</title>
    <style>
        /* --- BRANDING & VARIABLER --- */
        :root {
            --primary: #0a3024;       
            --secondary: #027b5f;     
            --bg-light: #e8f6f4;      
            --white: #ffffff;
            --text-dark: #1a1a1a;
            --accent: #d4af37;        
            --radius: 16px;
            --shadow: 0 10px 30px -10px rgba(10, 48, 36, 0.15);
            --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-light);
            color: var(--text-dark);
            padding-bottom: 80px;
            -webkit-font-smoothing: antialiased;
        }

        /* --- HEADER --- */
        header {
            background-color: var(--primary);
            color: var(--white);
            padding: 30px 20px 20px;
            text-align: center;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            margin-bottom: -20px;
            position: sticky; /* Sticky for å alltid være tilgjengelig */
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .logo {
            height: 45px;
            margin-bottom: 15px;
            display: block;
            margin-left: auto;
            margin-right: auto;
            filter: brightness(0) invert(1); 
            opacity: 0.9;
        }

        h1 {
            font-size: 1.4rem;
            font-weight: 400;
            letter-spacing: 0.5px;
            color: #d1e8e2;
            margin-bottom: 20px;
            display: none; /* Skjuler tittel på mobil for å spare plass, kan fjernes hvis ønskelig */
        }
        @media (min-width: 768px) { h1 { display: block; } }

        /* --- SØK --- */
        .search-container {
            max-width: 500px;
            margin: 0 auto;
            position: relative;
        }

        .search-box {
            width: 100%;
            padding: 16px 24px;
            border-radius: 50px;
            border: none;
            font-size: 16px; /* Hindrer zoom på iPhone */
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            outline: none;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            box-shadow: 0 4px 25px rgba(2, 123, 95, 0.3);
            transform: translateY(-2px);
        }

        /* --- GRID CONTAINER --- */
        .container {
            max-width: 1200px;
            margin: 40px auto 0;
            padding: 0 15px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 768px) { .container { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 1100px) { .container { grid-template-columns: repeat(3, 1fr); } }

        /* --- BORDKORT --- */
        .card {
            background: var(--white);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255,255,255,0.5);
            transition: transform 0.3s ease, opacity 0.3s;
            
            /* VIKTIG FIX: Dette sørger for at autoscroll stopper FØR headeren dekker kortet */
            scroll-margin-top: 180px; 
        }

        .card-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #f0f0f0;
            background-color: #fafdfc;
        }

        .card-title {
            color: var(--primary);
            font-size: 1.25rem;
            font-weight: 700;
        }

        .card-meta {
            font-size: 0.85rem;
            color: var(--secondary);
            margin-top: 4px;
            font-weight: 500;
        }

        /* --- VISUELL SIRKEL --- */
        .visual-area {
            position: relative;
            width: 100%;
            padding: 30px 0;
            display: flex;
            justify-content: center;
            background: radial-gradient(circle at center, #fff 0%, #f7fffd 70%);
        }

        .table-circle {
            width: 180px;
            height: 180px;
            position: relative;
            border-radius: 50%;
            background-color: var(--primary);
            box-shadow: 0 8px 25px rgba(10, 48, 36, 0.25);
            border: 6px solid #eefef9;
            outline: 1px solid var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-size: 2rem;
            font-weight: 700;
            z-index: 1;
        }

        .seat-dot {
            position: absolute;
            width: 32px;
            height: 32px;
            background-color: var(--white);
            border: 2px solid var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 800;
            color: var(--primary);
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
            transition: transform 0.2s, background-color 0.2s;
            z-index: 10;
        }

        /* --- GJESTELISTE --- */
        .guest-list {
            padding: 20px;
            background-color: var(--white);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px 15px;
        }

        .guest-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            padding: 6px;
            border-radius: 8px;
            transition: background-color 0.2s;
            cursor: pointer;
        }
        
        .guest-item:active { background-color: #f0f9f6; }

        .guest-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background-color: var(--bg-light);
            color: var(--secondary);
            border-radius: 50%;
            font-size: 11px;
            font-weight: 700;
            margin-right: 10px;
            flex-shrink: 0;
            border: 1px solid rgba(2, 123, 95, 0.2);
        }

        .guest-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: var(--text-dark);
            font-weight: 500;
        }

        /* --- STATES --- */
        .card.dimmed { opacity: 0.4; transform: scale(0.98); }
        
        .guest-item.highlight { background-color: var(--primary); }
        .guest-item.highlight .guest-name { color: var(--white); }
        .guest-item.highlight .guest-number { background-color: var(--accent); color: var(--primary); border-color: var(--accent); }

        .seat-dot.highlight {
            background-color: var(--accent);
            border-color: var(--primary);
            transform: scale(1.3);
            z-index: 20;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        }

        /* SKJULER TOMME PLASSER HELT */
        .seat-dot.empty { display: none; }
        .guest-item.empty-seat { display: none; }

    </style>
</head>
<body>

    <header>
        <img src="https://www.gronnjobb.no/hubfs/Imported%20images/logo-02.svg" alt="Grønn Jobb" class="logo">
        <h1>Bordplassering</h1>
        
        <div class="search-container">
            <input type="text" class="search-box" id="searchInput" placeholder="Søk etter ditt navn...">
        </div>
    </header>

    <div class="container" id="app"></div>

    <script>
        // --- DATA (Lest loddrett fra Excel-listen din) ---
        const tablesData = [
            // Bord 1 (Kolonne 1)
            ["Martin", "Mathias", "Mattis", "Patrick J", "Rene", "Christine", "Jeanett", "Linn", "Malin"],
            // Bord 2 (Kolonne 2)
            ["Gøril", "Hanne", "Frederic", "Håvar", "Andrea", "Anette", "Marthe", "Tommy", "TB"],
            // Bord 3 (Kolonne 3)
            ["Patrick H", "Madelen", "Camilla A", "Rasmus", "Steffen", "Terje L", "Stig Owe", "Therese G", "Josefine"],
            // Bord 4 (Kolonne 4)
            ["Lotte", "Marielle", "Tina", "Line", "Silje O", "Ørjan", "Per", "Adam", "Tonje"],
            // Bord 5 (Kolonne 5)
            ["Mathias", "Simon", "Silje S", "Miriam", "Idris", "Tobias", "Mats", "Marius", "Terje K"],
            // Bord 6 (Kolonne 6)
            ["Katrine He", "Camilla L", "Sonja", "Dina", "Gine", "Eli", "Oddbjørn", "Willy", "Christer M"],
            // Bord 7 (Kolonne 7)
            ["Therese D", "Marte", "Katrine Ha", "Anki", "Aslaug", "Ingrid Lene", "Lars", "Christer J", "Mentor"],
            // Bord 8 (Kolonne 8)
            ["Nina", "Linda A", "Anita A", "Christian", "Linda H", "Cecilie", "Andrine", "Therese H", "Rita"],
            // Bord 9 (Kolonne 9 - 10 plasser)
            ["Mona", "Albina", "Julie", "Dan Mario", "Pezhman", "Joachim", "Hemmelig", "Petter", "Preben", "Peter"]
        ];

        // Bygg data-struktur
        const tables = [];
        tablesData.forEach((guestNames, index) => {
            const tableId = index + 1;
            const capacity = 10; 
            let guests = [...guestNames];
            while(guests.length < capacity) { guests.push(null); }
            tables.push({ id: tableId, name: "Bord " + tableId, guests: guests, capacity: capacity });
        });

        // --- RENDER ---
        const app = document.getElementById('app');

        function render() {
            app.innerHTML = '';
            tables.forEach(table => {
                const card = document.createElement('div');
                card.className = 'card';
                card.id = `card-${table.id}`;

                const filledSeats = table.guests.filter(g => g !== null).length;
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-title">${table.name}</div>
                        <div class="card-meta">${filledSeats} gjester</div>
                    </div>
                `;

                // Visuell sirkel
                const visualArea = document.createElement('div');
                visualArea.className = 'visual-area';
                const tableCircle = document.createElement('div');
                tableCircle.className = 'table-circle';
                tableCircle.innerText = table.id;

                table.guests.forEach((guest, index) => {
                    const seatNum = index + 1;
                    const angle = (index * (360 / table.capacity)) - 90;
                    const angleRad = angle * (Math.PI / 180);
                    const distance = 110;

                    const dot = document.createElement('div');
                    dot.className = 'seat-dot';
                    if(!guest) dot.classList.add('empty'); 
                    dot.innerText = seatNum;
                    dot.dataset.seatIndex = index; 
                    
                    const x = Math.cos(angleRad) * distance;
                    const y = Math.sin(angleRad) * distance;
                    dot.style.transform = `translate(${x}px, ${y}px)`;
                    tableCircle.appendChild(dot);
                });
                visualArea.appendChild(tableCircle);
                card.appendChild(visualArea);

                // Liste
                const listArea = document.createElement('div');
                listArea.className = 'guest-list';
                table.guests.forEach((guest, index) => {
                    const item = document.createElement('div');
                    item.className = 'guest-item';
                    item.dataset.seatIndex = index;
                    
                    if (guest) {
                        item.dataset.name = guest.toLowerCase();
                        item.innerHTML = `<div class="guest-number">${index + 1}</div><div class="guest-name">${guest}</div>`;
                    } else {
                        item.classList.add('empty-seat');
                        item.innerHTML = ``;
                    }
                    // Klikk for å markere manuelt
                    item.addEventListener('click', () => {
                        if(!guest) return;
                        card.querySelectorAll('.highlight').forEach(el => el.classList.remove('highlight'));
                        item.classList.add('highlight');
                        const dot = tableCircle.querySelector(`.seat-dot[data-seat-index="${index}"]`);
                        if(dot) dot.classList.add('highlight');
                    });
                    listArea.appendChild(item);
                });
                card.appendChild(listArea);
                app.appendChild(card);
            });
        }

        // --- FORBEDRET SØK & SCROLL ---
        const searchInput = document.getElementById('searchInput');
        let scrollTimeout; // Variabel for å holde styr på forsinkelsen

        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase().trim();
            const cards = document.querySelectorAll('.card');
            const allItems = document.querySelectorAll('.guest-item');
            const allDots = document.querySelectorAll('.seat-dot');

            // 1. Reset alt umiddelbart
            allItems.forEach(el => el.classList.remove('highlight'));
            allDots.forEach(el => el.classList.remove('highlight'));
            cards.forEach(c => {
                c.classList.remove('dimmed');
                delete c.dataset.hasMatch;
            });

            // Avbryt eventuell ventende scroll hvis brukeren skriver mer
            clearTimeout(scrollTimeout);

            if (term.length === 0) return;

            // 2. Finn og marker treff umiddelbart
            let firstMatchElement = null;
            let globalMatchFound = false;

            allItems.forEach(item => {
                const name = item.dataset.name;
                if (name && name.includes(term)) {
                    globalMatchFound = true;
                    item.classList.add('highlight');
                    
                    const card = item.closest('.card');
                    const index = item.dataset.seatIndex;
                    const dot = card.querySelector(`.seat-dot[data-seat-index="${index}"]`);
                    if(dot) dot.classList.add('highlight');
                    card.dataset.hasMatch = "true";

                    // Lagre det aller første treffet vi finner
                    if (!firstMatchElement) {
                        firstMatchElement = item;
                    }
                }
            });

            // 3. Dimming
            if (globalMatchFound) {
                cards.forEach(card => {
                    if (card.dataset.hasMatch !== "true") card.classList.add('dimmed');
                });

                // 4. FORSINKET SCROLL (Debounce)
                // Vi venter 500ms etter siste tastetrykk før vi scroller
                scrollTimeout = setTimeout(() => {
                    if (firstMatchElement) {
                        // Sjekk om kortet allerede er synlig i viewporten for å unngå unødvendig hopping
                        const card = firstMatchElement.closest('.card');
                        const rect = card.getBoundingClientRect();
                        const isVisible = (rect.top >= 0 && rect.bottom <= window.innerHeight);

                        // Scroll kun hvis det er nødvendig eller langt unna
                        card.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'center' 
                        });
                    }
                }, 500); 
            }
        });

        // Start
        render();
    </script>
</body>
</html>
